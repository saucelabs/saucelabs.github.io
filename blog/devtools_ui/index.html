<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Chrome DevTools UI</title><link rel=alternate href=/index.xml type=application/atom+xml data-title="Sauce Labs Engineering Blog feed"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=5"><meta name=description content="Chrome DevTools has always been an essential feature in Sauce Labs for live testing real devices. This blog post reports about our recent revamp of the UI code."><meta name=author content="Sauce Labs Open Source Program Office"><meta name=generator content="Hugo 0.66.0"><meta name=theme-color content="#AC1414"><link rel=manifest href=/site.webmanifest><link rel=preconnect href=https://www.google-analytics.com><link rel=stylesheet href=https://opensource.saucelabs.com/plugins/bootstrap/bootstrap.min.css><link rel=stylesheet href=https://opensource.saucelabs.com/plugins/slick/slick.css><link rel=stylesheet href=https://opensource.saucelabs.com/plugins/themify-icons/themify-icons.css><link rel=stylesheet href=https://opensource.saucelabs.com/css/style.min.css media=screen><link rel="shortcut icon" href=https://opensource.saucelabs.com/images/favicon.ico><link rel=icon type=image/png sizes=32x32 href=https://opensource.saucelabs.com/images/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=https://opensource.saucelabs.com/images/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=https://opensource.saucelabs.com/images/apple-touch-icon.png><link rel=mask-icon color=#ac1414 href=https://opensource.saucelabs.com/images/safari-pinned-tab.svg><script src=https://cdn.cookielaw.org/scripttemplates/otSDKStub.js type=text/javascript data-domain-script=6d1eb79b-c89c-440f-87e8-dc9c37f0e44b></script><script type=text/javascript>function OptanonWrapper(){}</script><script async src="https://www.googletagmanager.com/gtag/js?id=UA-6735579-1"></script><script async src="https://platform-api.sharethis.com/js/sharethis.js#property=5f50fae56b5d9900194e28ff&product=inline-share-buttons"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','UA-6735579-1');if('serviceWorker'in navigator){navigator.serviceWorker.getRegistrations().then(function(registrations){for(let registration of registrations){registration.unregister();}});}</script><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"blog","name":"Chrome DevTools UI","headline":"Chrome DevTools UI","description":"Chrome DevTools has always been an essential feature in Sauce Labs for live testing real devices. This blog post reports about our recent revamp of the UI code.","inLanguage":"en-US","author":"Sakhi Mansoor","creator":"Sakhi Mansoor","accountablePerson":"Sakhi Mansoor","copyrightHolder":"Sakhi Mansoor","copyrightYear":"2021","datePublished":"2021-01-13 09:00:00 \x2b0600 \x2b0600","publisher":"Sauce Labs","logo":"https://opensource.saucelabs.com/images/appicons/icon-128x128.png","url":"https:\/\/opensource.saucelabs.com\/blog\/devtools_ui\/","wordCount":"1374","keywords":["ux","frontend","chrome","devtools","devtools-ui"]}</script><meta property="og:title" content="Chrome DevTools UI"><meta property="og:description" content="Chrome DevTools has always been an essential feature in Sauce Labs for live testing real devices. This blog post reports about our recent revamp of the UI code."><meta property="og:type" content="article"><meta property="og:url" content="https://opensource.saucelabs.com/blog/devtools_ui/"><meta property="og:image" content="https://opensource.saucelabs.com/images/blog/devtools-ui/after.jpg"><meta property="article:published_time" content="2021-01-13T09:00:00+06:00"><meta property="article:modified_time" content="2021-01-13T09:00:00+06:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://opensource.saucelabs.com/images/blog/devtools-ui/after.jpg"><meta name=twitter:title content="Chrome DevTools UI"><meta name=twitter:description content="Chrome DevTools has always been an essential feature in Sauce Labs for live testing real devices. This blog post reports about our recent revamp of the UI code."></head><body><div class=content-section><div class=preloader></div><header class="navigation fixed-top home-page"><nav class="navbar navbar-expand-lg navbar-dark home-page"><a class="navbar-brand invisible" id=home-page-logo href=https://opensource.saucelabs.com><img src=https://opensource.saucelabs.com/images/saucelabs_logo_black.svg alt="Sauce Labs Open Source"></a>
<a class="navbar-brand invisible" id=content-page-logo href=https://opensource.saucelabs.com><img src=https://opensource.saucelabs.com/images/saucelabs_logo_color.svg alt="Sauce Labs Open Source"></a>
<button class=navbar-toggler type=button data-toggle=collapse data-target=#navigation aria-controls=navigation aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse text-center" id=navigation><ul class="navbar-nav ml-auto pt-4"><li class=nav-item><a class=nav-link href=https://opensource.saucelabs.com>Home</a></li><li class=nav-item><a class=nav-link href=https://opensource.saucelabs.com/projects>Projects</a></li><li class=nav-item><a class=nav-link href=https://opensource.saucelabs.com/docs>Docs</a></li><li class=nav-item><a class=nav-link href=https://opensource.saucelabs.com/blog>Blog</a></li></ul></div></nav></header><section class="page-title bg-primary position-relative overflow-hidden"><div class=container><div class=row><div class="col-12 text-center"><h1 class=font-tertiary>Chrome DevTools UI</h1></div></div></div></section><section class=section><div class=container><div class=row><div class=col-lg-12><h3 class=font-tertiary>Chrome DevTools UI</h3><p class="font-secondary mb-5">Published on Jan 13, 2021
by
<a href=https://twitter.com/sakhisheikh class=text-primary>Sakhi Mansoor</a></p><div class=content><p>Chrome DevTools has always been an essential feature in Sauce Labs for live testing real devices. It allows users to inspect web pages in Android devices and use Chrome DevTools to debug issues.</p><h2 id=background>Background</h2><p>In 2016, we launched a Chrome DevTools application to our customers that enabled them to debug webpages in Chrome and Safari in Android and iOS devices respectively. We used the static assets provided by the Chromium team and cloned the whole repository of <a href=https://github.com/ChromeDevTools/devtools-frontend/tree/master/front_end>artifacts</a> in our product from their git source to render the DevTools UI. Some other browsers which use the Chromium DevTools protocol were also integrated with some limitations.</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/before.jpg><figcaption><p>Here is a screenshot of a live testing session debugging Chrome on Android.</p></figcaption></figure><p>In late 2019, we started seeing some serious issues in the Chrome DevTools feature, as some browser APIs were deprecated. The Chromium team rolled out those changes in early 2019 as they migrated all of the DevTools UI to web components, which helped in maintaining the huge codebase and improving their developer experience with more generic guidelines. This article <a href="https://developers.google.com/web/updates/2020/12/migrating-to-web-components?hl=en">DevTools architecture refresh: migrating to Web Components</a> entails more details on it. The problem was bigger than it seemed to be initially.</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/after-update.jpg><figcaption><p>As you can see the error in the image below: <code>document.registerElement</code> is not a function so this issue we encountered in the beginning.</p></figcaption></figure><p>First we tried to replace the deprecated APIs from the Chrome DevTools library code, but it was a cumbersome task as changes were massive and code is oriented as library code so we went for other approaches.</p><h2 id=consideration-we-made-to-solve-this-issue>Consideration we made to solve this issue</h2><p>The first thought that stirred our mind was to upgrade to the latest version of DevTools Frontend. After upgrading to the new version, we encountered few more issues. Case in point:</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/error-log.gif></figure><p>A few files were missing to render the DevTools UI. After digging into it further we found out that over the years the Chromium team has changed their build setup to compile Chrome DevTools frontend with some build script so assets are now generated on runtime. To build any Chromium project, you need to set up around 20GBs (as you can see in the image below). It was a somewhat complicated solution inclined more towards building a DevTools application instead of just using it, which didnâ€™t sound like a suitable fix at that point since it was affecting our customers on production.</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/fetch.gif></figure><h2 id=a-short-fix>A Short Fix</h2><p>We made the choice to go for a <strong>short term</strong> fix initially to add missing artifacts. After getting familiar with similar issues on Chromium Google source <a href="https://www.google.com/url?q=https://groups.google.com/g/google-chrome-developer-tools/c/RUYXxgATbeo/m/6wfd-mvmAgAJ&sa=D&ust=1610370981661000&usg=AOvVaw2798SP0pdDK4qSspF3NVBW">issues portal</a>, we found a way to fetch generated artifacts on runtime with chromium hosted repo for static assets like this:</p><blockquote><p><a href=https://chrome-devtools-frontend.appspot.com/serve_file/@f34bc3521507d3a2b58ad8ce5e63c2a7c13ff3b9/InspectorBackendCommands.js>https://chrome-devtools-frontend.appspot.com/serve_file/@f34bc3521507d3a2b58ad8ce5e63c2a7c13ff3b9/InspectorBackendCommands.js</a> ><br><sub>(The format is <code>@</code> followed by the Chromium git commit hash; the parameter in the path is the file name)</sub></p></blockquote><p>With this hosted service we were able to retrieve missing artifacts and Chrome DevTools was back to life.</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/after.jpg></figure><p>Fixing that particular API issue wasnâ€™t our only focus for this problem. As this issue began to happen, we got some insights about our product, including some serious improvements we need to make this feature more robust.</p><h2 id=an-intermediate-solution>An Intermediate Solution</h2><p>After this solution we began to see how we can make it a more flexible, reusable and scalable solution that would thank our future selves. With some more research we looked into <a href="https://www.google.com/url?q=https://chromium.googlesource.com/chromium/tools/depot_tools.git&sa=D&ust=1610370981662000&usg=AOvVaw2rR2OiUg_osv7zKvixfvBa">Chromium Depot tools</a> provided by the Chromium team to build any of their projects independently from your Chromium setup. This setup was easy and reliable as we were able to compile the DevTools frontend on our own and generated all required artifacts which were around 250MBs (a less complicated solution than having 20Gbs set up).</p><p>We again put all those artifacts in our product repository and shipped to the customers. It started working fine but it wasnâ€™t as scalable as we wanted it to be. At Sauce Labs we are migrating all features from our legacy codebase to a new React web app, and we needed the same solution for this feature. Here the real journey began â€” this is where we started thinking we should have a more reliable solution.</p><h2 id=long-term-solution>Long Term Solution</h2><p>The previous solution wasnâ€™t feasible in terms of developer experience since it had some constraints:
In order to build all DevTools artifacts you need to have depot tools and DevTools Frontend git source on the same machine as it requires some symlinks. We didnâ€™t want all of our developers to install these dependencies in their machines to make further needed changes to the DevTools feature.</p><p><strong>Motivation:</strong> At Sauce Labs, we strive to keep a sustained balance in both developer and user experience. Our goal was to craft this feature in a way which just not only benefits us but helps the community in a certain way. As we have seen in this quest to solve this issue, there are no suitable options for the open source community to consume DevTools UI easily integratable in their project. All available options are a bit dispersed in small parts as Chrome DevTools UI isnâ€™t commonly used as a standalone application so we decided to create such a solution. Also, we didnâ€™t want to replicate and manage the same code in our different projects.</p><p>After some useful discussions within our teams and even talking to the Chrome DevTools Team we reached the conclusion that we needed to build a completely independent webapp for DevTools UI, which can be later integrated in our projects and OSS can leverage it somehow.</p><p>The final solution was crafted with the help of a bunch of tools we use at Sauce Labs:
A Gitlab project consisting of several build scripts like fetching required dependencies to compile DevTool UI and keeping the built artifacts in gitlab to be used in our CI/CD pipelines later.</p><p>Here is an excerpt of one of our recipes to compile artifacts. In the first part, this script fetches depot tools and then clones the DevTools frontend repository. In the second part, it generated all the required artifacts that are needed to serve Chrome DevTools UI:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=color:#75715e>#!/bin/bash
</span><span style=color:#75715e></span>
<span style=color:#75715e>## cloning scripts by Chromium to build chrome devtools ui</span>
git clone https://chromium.googlesource.com/chromium/tools/depot_tools.git
export PATH<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$PATH<span style=color:#e6db74>:</span><span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span><span style=color:#e6db74>/depot_tools&#34;</span>
mkdir devtools <span style=color:#f92672>&amp;&amp;</span> cd devtools
fetch devtools-frontend
cd devtools-frontend

<span style=color:#75715e>## building artifacts</span>
gn gen out/Default
autoninja -C out/Default
</code></pre></div><p>All artifacts are stored in JFROG Artifactory with proper versioning as the Chromium team doesn&rsquo;t have any versioning scheme for it. This is quite helpful in order to roll back to a specific version. The final step is to push stored artifacts in dedicated AWS S3 buckets for DevTools UI artifacts in different data centres to alleviate latency issues to our customers over dedicated Cloudfront Distributions. A checksum technique is applied in order to speed up our CI/CD to use artifacts within Gitlab (stored in the first stage) instead of fetching from our artifactory repository and push to S3 bucket.</p><p>The best part of this solution is to ship changes to customers within a few clicks in the CI/CD.</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/pipeline.gif></figure><p>Here we have an overview of the architecture:</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/architecture.gif></figure><p><strong>Final Step:</strong> To integrate this UI into any webapp, all you need is pass your WebSocket debug URL of a webpage as a query param to establish connection between DevTools and your application.</p><blockquote><p><a href="https://da38tdtjguzrq.cloudfront.net/inspector.html?wss=$%7BwebSocketUrl%7D">https://da38tdtjguzrq.cloudfront.net/inspector.html?wss=${webSocketUrl}</a></p></blockquote><p>We configured those CDNs in our legacy and React application and saved storage resources from our repositories around 2GBs since the bespoke Chrome DevTools UI codebase and compiled artifacts were in the repository.</p><figure class="img-responsive text-center"><img src=/images/blog/devtools-ui/pr.gif></figure><p>Indeed, we learned throughout this journey how open communication within a company helps to have more resilient and robust solutions. It was an effort with the collaboration of different teams at Sauce Labs. Our short term and intermediate solutions helped us in giving some bandwidth to spend more time for this solution. This just didnâ€™t fix our problems, but also opened doors of opportunities for the OSS community. We are thankful to all of those who contributed to make this work and will be looking forward to the community if they can leverage it in their projects. The next subsequent blog will be focused on how we can integrate DevTools UI in an independent project.</p><p>Thanks for reading and feel free to share and reach out if you have any questions.</p></div></div><div class=sharethis><p>Please share!</p><div class=sharethis-inline-share-buttons></div></div></div></div></section></div><footer class="bg-footer footer-section"><div class=section><div class=container><div class=row><div class=col-md-3><h5><strong>Links</strong></h5><p class=footer-item-text><a href=https://opensource.saucelabs.com/projects class=footer-item-text>Projects</a></p><p class=footer-item-text><a href=https://opensource.saucelabs.com/docs class=footer-item-text>Docs</a></p><p class=footer-item-text><a href=https://opensource.saucelabs.com/blog class=footer-item-text>Blog</a></p></div><div class=col-md-3><h5><strong>Organizations</strong></h5><p class=footer-item-text><a href=https://www.w3.org/ class=footer-item-text rel=noreferrer target=_blank>W3C</a></p><p class=footer-item-text><a href=https://www.linuxfoundation.org/ class=footer-item-text rel=noreferrer target=_blank>Linux Foundation</a></p><p class=footer-item-text><a href=https://openjsf.org/ class=footer-item-text rel=noreferrer target=_blank>OpenJS Foundation</a></p><p class=footer-item-text><a href=https://sfconservancy.org/ class=footer-item-text rel=noreferrer target=_blank>SFC</a></p><p class=footer-item-text><a href=https://todogroup.org/ class=footer-item-text rel=noreferrer target=_blank>TODO Group</a></p><p class=footer-item-text><a href=https://mobilenativefoundation.org/ class=footer-item-text rel=noreferrer target=_blank>Mobile Native Foundation</a></p></div><div class=col-md-3><h5><strong>Connect with us</strong></h5><p class=footer-item-text><a href=https://saucelabs.com/ class=footer-item-text target=_blank rel=noreferrer><i class="ti-world icon-footer"></i>Website</a></p><p class=footer-item-text><a href=https://www.linkedin.com/company/sauce-labs/ class=footer-item-text target=_blank rel=noreferrer><i class="ti-linkedin icon-footer"></i>Sauce Labs</a></p><p class=footer-item-text><a href=https://github.com/saucelabs class=footer-item-text target=_blank rel=noreferrer><i class="ti-github icon-footer"></i>@saucelabs</a></p><p class=footer-item-text><a href=https://twitter.com/saucelabs/ class=footer-item-text target=_blank rel=noreferrer><i class="ti-twitter-alt icon-footer"></i>@saucelabs</a></p><p class=footer-item-text><a href=mailto:opensource@saucelabs.com class=footer-item-text target=_blank rel=noreferrer><i class="ti-email icon-footer"></i>opensource@saucelabs.com</a></p></div></div><div class="row pt-5"><div class=col-md-12><small class=mb-0>Â© 2023 Sauce Labs Inc., all rights reserved. SAUCE and SAUCE LABS are registered trademarks owned by Sauce Labs Inc. in the United States, EU, and may be registered in other jurisdictions.</small></div></div></div></div></footer><script rel=preload src=https://opensource.saucelabs.com/plugins/jQuery/jquery.min.js></script><script rel=preload src=https://opensource.saucelabs.com/plugins/bootstrap/bootstrap.min.js></script><script rel=preload src=https://opensource.saucelabs.com/plugins/slick/slick.min.js></script><script rel=preload src=https://opensource.saucelabs.com/plugins/shuffle/shuffle.min.js></script><script src=https://opensource.saucelabs.com/js/script.min.js></script></body></html>